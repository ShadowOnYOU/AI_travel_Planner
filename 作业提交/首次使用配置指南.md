# 🔧 首次使用必读：API密钥配置指南

## ⚠️ 重要提醒

**即使Docker镜像已预配置所有API密钥，首次使用时仍必须通过配置页面进行初始化设置！**

跳过此步骤将导致：
- ❌ AI行程规划功能完全无法使用
- ❌ 地图显示异常或无法加载
- ❌ 系统显示"API配置错误"提示

## 🚀 配置步骤（必须完成）

### Step 1: 启动应用
```bash
docker run --rm -p 3000:3000 --platform linux/amd64 crpi-ttmopfgqdmld0jn5.cn-hangzhou.personal.cr.aliyuncs.com/ai_by_sgh/ai-travel-planner:latest
```

### Step 2: 访问配置页面
在浏览器中打开：**http://localhost:3000/config**

### Step 3: 配置高德地图API

1. 点击"**高德地图**"标签页
2. 在"API Key"输入框中填入：
   ```
   1e967f9e5d863f52e8e76a8b7c381669
   ```
3. 点击"**🧪 测试连接**"按钮
4. 等待测试完成，确保显示"**✅ 连接成功**"

### Step 4: 配置阿里云百炼AI

1. 点击"**阿里云百炼**"标签页
2. 填入以下信息：
   - **API Key**: `sk-7b2ff1814ecb499d89d56e86af030b19`
   - **Base URL**: `https://dashscope.aliyuncs.com/compatible-mode/v1`
   - **Model ID**: `qwen-plus`
3. 点击"**🧪 测试连接**"按钮
4. 等待测试完成，确保显示"**✅ 连接成功**"

### Step 5: 保存配置

1. 点击页面底部的"**💾 保存配置**"按钮
2. 确认看到保存成功的提示信息
3. 验证所有API状态显示为"**✅ 已连接**"

## ✅ 配置验证

完成配置后，您应该看到：

### 高德地图API状态
```
🗺️ 高德地图 API
状态：✅ 已连接
最后测试：刚刚
```

### 阿里云百炼AI状态
```
🤖 阿里云百炼 AI
状态：✅ 已连接  
模型：qwen-plus
最后测试：刚刚
```

## 🎯 配置完成后的功能验证

### 1. 测试AI规划功能
- 访问：http://localhost:3000/plan
- 填写任意旅行需求
- 点击"生成行程"
- **预期结果**：成功生成详细行程

### 2. 测试地图功能  
- 在生成的行程中点击"🗺️ 查看地图"
- **预期结果**：显示带有景点标记的地图

## 🚨 常见问题

### Q: 为什么镜像已预配置还需要手动设置？
**A**: 出于安全考虑，API密钥需要通过配置界面进行初始化激活。这确保了密钥的正确加载和验证。

### Q: 配置过程中显示"连接失败"怎么办？
**A**: 
1. 检查网络连接是否正常
2. 确认API密钥输入正确（复制粘贴推荐）
3. 重新点击"测试连接"
4. 如果持续失败，可能是API密钥已过期

### Q: 配置完成后功能仍然异常？
**A**:
1. 确认已点击"保存配置"按钮
2. 刷新浏览器页面
3. 重新访问配置页面验证状态
4. 检查浏览器控制台是否有错误信息

### Q: 可以跳过某个API的配置吗？
**A**: 不建议跳过。高德地图API影响地图功能，阿里云百炼AI影响行程规划功能。两者都是核心功能所必需的。

## 📞 技术支持

如果配置过程中遇到问题：
1. 查看浏览器控制台错误信息
2. 检查Docker容器日志：`docker logs [容器名]`
3. 参考完整的故障排查文档
4. 联系开发者：GitHub Issues

---

**🎯 配置成功标志**：
- 所有API状态显示"✅ 已连接"
- AI规划功能可以正常生成行程
- 地图可以正常显示景点和路线

完成以上配置后，您就可以尽情体验AI Travel Planner的所有功能了！🌟